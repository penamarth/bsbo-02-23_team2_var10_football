# Прецедент: Покупка абонемента

**Рамки.** Система продажи билетов на футбол.

**Уровень.** Задача, определенная пользователем.

**Основной исполнитель.** Кассир.

## Заинтересованные лица и их требования

- **Кассир.** Хочет быстро оформить продажу абонемента на сезон, получить подтверждение оплаты и выдать абонемент покупателю.
- **Покупатель.** Хочет купить абонемент на все домашние матчи сезона на удобное место, получить информацию о цене и списке матчей.
- **Система.** Должна проверить доступность места для всех матчей сезона, забронировать место, принять оплату, выдать абонемент и зарезервировать место на все матчи.
- **Клуб.** Заинтересован в продаже максимального количества абонементов для обеспечения стабильной посещаемости.

## Предусловия

- Кассир авторизован в системе.
- Начался период продажи абонементов (начало сезона).
- В системе есть информация о всех домашних матчах сезона.
- Есть свободные места для абонементов.

## Результаты (Постусловия)

- Абонемент продан и выдан покупателю.
- Место зарезервировано на все домашние матчи сезона.
- Оплата зарегистрирована в системе.
- Информация об абонементе сохранена.

## Основной успешный сценарий

1. Покупатель обращается к кассиру с желанием купить абонемент на сезон.
2. Кассир запрашивает у системы информацию о текущем сезоне.
3. Система отображает название сезона и количество домашних матчей.
4. Кассир запрашивает список доступных для абонемента мест.
5. Система отображает схему стадиона с местами, доступными на все матчи сезона.
6. Кассир вместе с покупателем выбирает подходящее место.
7. Система показывает список всех матчей, включенных в абонемент.
8. Система рассчитывает стоимость абонемента (базовая цена × количество матчей × коэффициент категории места).
9. Кассир сообщает покупателю стоимость.
10. Покупатель соглашается и выбирает способ оплаты.
11. Кассир вводит данные покупателя (ФИО, телефон, email).
12. Система обрабатывает оплату.
13. Система генерирует абонемент с уникальным номером.
14. Система резервирует выбранное место на все матчи сезона.
15. Система печатает абонемент.
16. Кассир выдает абонемент покупателю.
17. Система помечает место как занятое абонементом и отправляет уведомление.

## Расширения (альтернативные потоки)

**5а. Нет мест, свободных на все матчи сезона.**
1. Система сообщает об отсутствии мест для абонемента.
2. Кассир предлагает покупателю билеты на отдельные матчи.

**12а. Оплата отклонена.**
1. Система сообщает об ошибке оплаты.
2. Кассир предлагает альтернативный способ оплаты или отменяет покупку.

**3а. Период продажи абонементов завершен.**
1. Система сообщает, что продажа абонементов закрыта.
2. Кассир предлагает покупку билетов на отдельные матчи.

**11а. Покупатель хочет оформить несколько абонементов.**
1. Кассир выбирает несколько мест.
2. Система резервирует все места на весь сезон.
3. Процесс продолжается для всех абонементов одновременно.

**15а. Принтер не работает.**
1. Система сохраняет абонемент в электронном виде.
2. Кассир отправляет абонемент на email покупателя.

## Специальные требования

- Абонемент действителен только на домашние матчи команды.
- Место должно быть свободно на все матчи сезона.
- Стоимость абонемента должна быть выгоднее покупки билетов на каждый матч отдельно.
- Абонемент должен содержать: номер, сезон, место, список матчей, цену, данные владельца, QR-код.

## Список технологий и типов данных

- Сезон: string (формат "2024-2025").
- Список матчей: List<Match>.
- Базовая цена: decimal (за один матч).

## Частота использования

Активно в начале сезона, редко в течение сезона.

## Открытые вопросы

- Можно ли передавать абонемент другому лицу на отдельные матчи?
- Есть ли возможность возврата абонемента?
- Предусмотрены ли скидки для постоянных болельщиков?

