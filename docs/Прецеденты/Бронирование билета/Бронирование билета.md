# Прецедент: Бронирование билета

**Рамки.** Система продажи билетов на футбол.

**Уровень.** Задача, определенная пользователем.

**Основной исполнитель.** Кассир.

## Заинтересованные лица и их требования

- **Кассир.** Хочет быстро забронировать место для покупателя без немедленной оплаты.
- **Покупатель.** Хочет зарезервировать место, чтобы иметь время на принятие решения о покупке (24 часа).
- **Система.** Должна временно заблокировать место, установить срок действия брони, автоматически освободить место при истечении срока.
- **Стадион.** Заинтересован в том, чтобы бронирования не блокировали места надолго и не снижали продажи.

## Предусловия

- Кассир авторизован в системе.
- В системе есть информация о предстоящих матчах.
- На выбранный матч есть доступные места.
- Покупатель предоставил контактные данные.

## Результаты (Постусловия)

- Бронирование создано с уникальным номером.
- Место временно заблокировано (на 24 часа).
- Информация о бронировании сохранена с указанием срока действия.
- Покупателю выдана информация о бронировании.

## Основной успешный сценарий

1. Покупатель обращается к кассиру с просьбой забронировать билет на конкретный матч.
2. Кассир запрашивает у системы список предстоящих матчей.
3. Система отображает список матчей.
4. Кассир выбирает нужный матч.
5. Система отображает схему стадиона с доступными местами.
6. Кассир вместе с покупателем выбирает подходящее место.
7. Кассир вводит данные покупателя (ФИО, телефон).
8. Кассир подтверждает создание бронирования.
9. Система проверяет доступность места.
10. Система создает бронирование с уникальным номером.
11. Система устанавливает срок действия брони (24 часа от текущего момента).
12. Система помечает место как забронированное.
13. Система выдает кассиру номер бронирования и срок действия.
14. Кассир сообщает покупателю номер брони и дату истечения.
15. Система отправляет уведомление другим кассам о бронировании места.

## Расширения (альтернативные потоки)

**9а. Место уже занято или забронировано.**
1. Система сообщает, что место недоступно.
2. Кассир предлагает выбрать другое место.
1. Покупатель предоставляет номер бронирования.
2. Кассир вводит номер в систему.
3. Система находит бронирование и проверяет срок действия.
**14а. Покупатель хочет отменить бронирование до истечения срока.**
- Система должна автоматически отслеживать и отменять истекшие бронирования.
- При создании брони оплата не требуется.
- Номер бронирования: string (формат "R-XXXXXXXX").
- Срок действия: DateTime (текущее время + 24 часа).
- Статус брони: enum (Active, Expired, Converted, Cancelled).

## Частота использования

Несколько раз в день, особенно при телефонных обращениях.

## Открытые вопросы

- Нужно ли отправлять SMS-напоминание о истечении брони?
- Можно ли продлить бронирование?
- Нужна ли предоплата для бронирования VIP-мест?
## Список технологий и типов данных

- Срок действия бронирования - 24 часа.
- Один покупатель может иметь не более 3 активных бронирований одновременно.
- Забронированное место не доступно для продажи другим покупателям.
1. Покупатель обращается к кассиру с номером брони.
## Специальные требования

2. Кассир отменяет бронирование в системе.
3. Место освобождается немедленно.

4. Если бронь действительна, система конвертирует её в билет (запускается процесс оплаты и выдачи билета).
5. Если бронь истекла, кассир сообщает об этом и предлагает забронировать заново.

3. Процесс возвращается к шагу 6.

**Покупатель возвращается для оплаты брони:**

3. Место освобождается и становится доступным для продажи.
4. Система отправляет уведомление об освобождении места.

