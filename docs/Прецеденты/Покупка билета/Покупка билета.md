# Прецедент: Покупка билета

**Рамки.** Система продажи билетов на футбол.

**Уровень.** Задача, определенная пользователем.

**Основной исполнитель.** Кассир.

## Заинтересованные лица и их требования

- **Кассир.** Хочет быстро и точно оформить продажу билета, получить подтверждение оплаты и выдать билет покупателю.
- **Покупатель.** Хочет купить билет на удобное место, получить информацию о цене, оплатить удобным способом и получить билет.
- **Система.** Должна проверить доступность места, зарезервировать его на время оформления, принять оплату, выдать билет и обновить информацию о доступных местах.
- **Стадион.** Заинтересован в корректном учете проданных билетов и максимальной заполняемости.

## Предусловия

- Кассир авторизован в системе.
- В системе есть информация о предстоящих матчах.
- На выбранный матч есть доступные места.

## Результаты (Постусловия)

- Билет продан и выдан покупателю.
- Место помечено как проданное.
- Оплата зарегистрирована в системе.
- Информация о проданном билете сохранена.

## Основной успешный сценарий

1. Покупатель обращается к кассиру с желанием купить билет на конкретный матч.
2. Кассир запрашивает у системы список предстоящих матчей.
3. Система отображает список матчей с датами и командами.
4. Кассир выбирает нужный матч.
5. Система отображает схему стадиона с доступными местами и ценами по категориям.
6. Кассир вместе с покупателем выбирает подходящее место.
7. Система резервирует выбранное место на 5 минут.
8. Система рассчитывает стоимость билета в зависимости от категории места.
9. Кассир сообщает покупателю стоимость.
10. Покупатель соглашается и выбирает способ оплаты (наличные/карта).
11. Кассир вводит данные покупателя (ФИО, телефон).
12. Система обрабатывает оплату.
13. Система генерирует билет с уникальным номером.
14. Система печатает билет.
15. Кассир выдает билет покупателю.
16. Система помечает место как проданное и отправляет уведомление другим кассам.

## Расширения (альтернативные потоки)

**5а. Все места на выбранный матч проданы.**
1. Система сообщает об отсутствии мест.
2. Кассир предлагает покупателю выбрать другой матч.

**7а. За 5 минут оплата не произведена.**
1. Система автоматически снимает резервирование.
2. Кассир начинает процесс заново.

**12а. Оплата отклонена (недостаточно средств на карте).**
1. Система сообщает об ошибке оплаты.
2. Кассир предлагает альтернативный способ оплаты или отменяет покупку.

**6а. Покупатель хочет несколько билетов.**
1. Кассир выбирает несколько мест.
2. Система резервирует все выбранные места.
3. Процесс продолжается для всех билетов одновременно.

**14а. Принтер не работает.**
1. Система сохраняет билет в электронном виде.
2. Кассир отправляет билет на email покупателя.

## Специальные требования

- Резервирование места должно быть видимо всем кассам в реальном времени.
- Время на оформление одного билета не должно превышать 3 минут.
- Билет должен содержать: номер, матч, место, цену, дату покупки, QR-код.

## Список технологий и типов данных

- Данные о матче: ID матча, дата и время в формате DateTime.
- Данные о месте: сектор (string), ряд (int), место (int).
- Способ оплаты: enum (Cash, Card).

## Частота использования

Постоянно, в часы работы касс.

## Открытые вопросы

- Нужна ли возможность оплаты онлайн через систему?
- Какие скидки предусмотрены для различных категорий покупателей?
